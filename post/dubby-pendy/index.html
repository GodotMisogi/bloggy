<!DOCTYPE html> 
<html lang="en">

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<script src="//cdn.rawgit.com/paulrosen/abcjs/master/bin/abcjs_basic_3.0-min.js"></script>
<head prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# website: http://ogp.me/ns/website#">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <meta name="description" content="">
    <meta property="og:title" content="Dubby Pendy - A Double Pendulum Simulator">
    
    <meta property="og:type" content="article">
    <meta property="article:published_time" content="2016-12-27">
    
    <meta property="og:description" content="">
    <meta property="og:url" content="https://godot-bloggy.xyz/post/dubby-pendy/">
    <meta property="og:site_name" content="Arjit Seth">
    
    <meta property="og:tags" content="Physics">
    
    <meta property="og:tags" content="Programming">
    
    <meta name="generator" content="Hugo 0.68.3" />
    <title>Dubby Pendy - A Double Pendulum Simulator</title>
    
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://godot-bloggy.xyz/css/style.css">
    <link href="" rel="alternate" type="application/rss+xml" title="Arjit Seth" />
    <link href="https://godot-bloggy.xyz/css/prism.css" rel="stylesheet" />

    
    
    
     <link rel="shortcut icon" href="https://godot-bloggy.xyz//pp.jpg?" type="image/x-icon">
    
    <script src="//cdn.rawgit.com/paulrosen/abcjs/master/bin/abcjs_plugin_3.0-min.js" type="text/javascript"></script>
    <script type="text/javascript">ABCJS.plugin.hide_abc = true;</script>
    
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-89998292-1', 'auto');
    ga('send', 'pageview');
    window.baseURL = "https:\/\/godot-bloggy.xyz\/";
    </script>
  
</head>
<body>
<nav class="navbar navbar-default navbar-fixed-top visible-xs">
	<div class="container-fluid">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			
				<a class="navbar-brand" href="https://godot-bloggy.xyz/">｢ALL FICTION｣</a>
			
		</div>
		<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
			<ul class="nav navbar-nav">
				
				
					<li><a href="https://godot-bloggy.xyz/about">About</a></li>
				
					<li><a href="https://godot-bloggy.xyz/">Blog</a></li>
				
					<li><a href="https://godot-bloggy.xyz/project/">Projects</a></li>
				
			</ul>
		</div>
	</div>
</nav>
<div class="container-fluid">
	<div class="row">
		
<div id="menu" class="hidden-xs col-sm-4 col-md-3">
	<div id="menu-content" class="vertical-align">
		
			<h1 class="text-center"><a href="https://godot-bloggy.xyz/">｢ALL FICTION｣</a></h1>
		
		
		
			<small class="text-center center-block">ARJIT SETH</small>
		
		
		
			<img id="profile-pic" src="https://godot-bloggy.xyz//img/Logo.png" alt="My Picture" class="center-block">
		
		<div id="social" class="text-center">
			<a href="mailto:arjitseth@gmail.com"><i class="fa fa-envelope-o fa-2x"></i></a>
			<a href="https://www.linkedin.com/in/arjit-seth" target="new"><i class="fa fa-linkedin fa-2x"></i></a>
			<a href="https://github.com/GodotMisogi" target="new"><i class="fa fa-github fa-2x"></i></a>
			<a href="https://twitter.com/ArjitSeth" target="new"><i class="fa fa-twitter fa-2x"></i></a>
		</div>
		<div id="links" class="text-center">
			
			
				<a href="https://godot-bloggy.xyz/about">About</a>
			
				<a href="https://godot-bloggy.xyz/">Blog</a>
			
				<a href="https://godot-bloggy.xyz/project/">Projects</a>
			
		</div>
	</div>
</div>
		<div id="content" class="col-xs-12 col-sm-8 col-md-9">
			<div class="row">
				<div id="post" class="col-sm-offset-1 col-sm-10 col-md-10 col-lg-8">

<main>
	<header>
		<h1>Dubby Pendy - A Double Pendulum Simulator</h1>
	</header>

	<article>
		<p>Learning about Lagrangian and Hamiltonian mechanics introduced me to an entirely new way of solving physics problems. The first time I&rsquo;d read about this topic was in <a href="http://www.feynmanlectures.caltech.edu/II_19.html">The Principle of Least Action</a> chapter in <a href="http://www.feynmanlectures.caltech.edu/II_toc.html">Vol. 2 of The Feynman Lectures on Physics</a>. I was introduced to a different perspective of viewing the physical world, perhaps a more general one than Newton&rsquo;s laws.</p>
<p>A famous example of a system whose equations of motion can be more easily attained using Lagrangian or Hamiltonian mechanics is the double pendulum. I saw a <a href="http://scienceworld.wolfram.com/physics/DoublePendulum.html">Wolfram Science animation</a> of the system, but it didn&rsquo;t have the right <code>a e s t h e t i c</code> for me, and I wanted to write one of my own to investigate the system for various initial conditions and its chaotic behaviour.</p>
<p>The following shows the double pendulum system:</p>
<!-- raw HTML omitted -->
<p>The Lagrangian of the system is:</p>
<p>$$ \mathcal{L} = T - V $$
$$ T = \frac{1}{2}m_1 l_1^2 \dot{\theta}_1^2 + \frac{1}{2}m_2\left[l_1^2 \dot{\theta}_1^2 + l_2^2 \dot{\theta}_2^2 + 2l_1 l_2 \dot{\theta}_1 \dot{\theta}_2 \cos(\theta_1 - \theta_2)\right]$$
$$ V = -(m_1 + m_2)gl_1\cos \theta_1 - m_2gl_2\cos\theta_2 $$</p>
<p>After a <a href="http://scienceworld.wolfram.com/physics/DoublePendulum.html">very long derivation</a>, Hamilton&rsquo;s equations can be obtained:</p>
<p>$$ \dot{\theta_1} = \frac{l_2 p_{\theta_1} - l_1 p_{\theta_2}\cos(\theta_1 - \theta_2)}{l_1^2 l_2[m_1 + m_2\sin^2(\theta_1-\theta_2)]} $$
$$ \dot{\theta_2} = \frac{l_1 (m_1 + m_2)p_{\theta_1} - l_2 m_2 p_{\theta_1}\cos(\theta_1 - \theta_2)}{l_1^2 l_2[m_1 + m_2\sin^2(\theta_1-\theta_2)]} $$
$$ \dot{p}_{\theta_1} = -(m_1 + m_2)gl_1\sin\theta_1 - C_1 + C_2$$
$$ \dot{p}_{\theta_2} = -m_2gl_2\sin\theta_2 + C_1 - C_2$$
$$ C_1 = \frac{p_{\theta_1}p_{\theta_2}\sin(\theta_1-\theta_2)}{l_1 l_2[m_1 + m_2\sin^2(\theta_1-\theta_2)]} $$
$$ C_2 = \frac{l_2^2 m_2 p_{\theta_1}^2 + l_1^2(m_1 + m_2)p_{\theta_2}^2 - l_1 l_2 m_2 p_{\theta_1} p_{\theta_2} \cos(\theta_1 - \theta_2)}{2l_1^2 l_2^2[m_1 + m_2\sin^2(\theta_1-\theta_2)]^2}\sin[2(\theta_1 - \theta_2)] $$</p>
<p>These are very formidable-looking equations, and it is almost impossible to determine the particle trajectories by solving these equations analytically! So how does one solve it for practical purposes? Numerical methods and programming. I used Lua to program the simulator, including the <a href="https://love2d.org">LÖVE</a> framework for the graphics.</p>
<p>Since the only data structure in Lua is a table, I decided to see how I could make use of that property for this program. Lua doesn&rsquo;t have functions to perform scalar multiplication or addition between tables, so I wrote some:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-lua" data-lang="lua"><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">directSum</span>(a, b)
	<span style="color:#66d9ef">local</span> c <span style="color:#f92672">=</span> {}
	<span style="color:#66d9ef">for</span> i,v <span style="color:#66d9ef">in</span> pairs(a) <span style="color:#66d9ef">do</span>
		c[i] <span style="color:#f92672">=</span> a[i] <span style="color:#f92672">+</span> b[i]
	<span style="color:#66d9ef">end</span>
	<span style="color:#66d9ef">return</span> c
<span style="color:#66d9ef">end</span>

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">scalarMultiply</span>(scalar, table)
	<span style="color:#66d9ef">local</span> output <span style="color:#f92672">=</span> {}
	<span style="color:#66d9ef">for</span> i,v <span style="color:#66d9ef">in</span> pairs(table) <span style="color:#66d9ef">do</span>
		output[i] <span style="color:#f92672">=</span> scalar<span style="color:#f92672">*</span>table[i]
	<span style="color:#66d9ef">end</span>
	<span style="color:#66d9ef">return</span> output
<span style="color:#66d9ef">end</span>
</code></pre></div><p>So now I can store values, such as the initial conditions and parameters of the system in a table and perform basic arithmetic operations between tables to change values. Now to implement the physics of the problem.</p>
<p>First, I defined a generator that randomly generates initial values (within a given range) of the masses of the bobs, the lengths of the rods, their angles with respect to the vertical, their initial angular velocities and calculated the momenta of the bobs. This is fed into a table called <code>data</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-lua" data-lang="lua"><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">Generator</span>()
	
	<span style="color:#66d9ef">local</span> self <span style="color:#f92672">=</span> {}
	
	self.m1 <span style="color:#f92672">=</span> love.math.random( <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">10</span> )
	self.m2 <span style="color:#f92672">=</span> love.math.random( <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">10</span> )
	self.l1 <span style="color:#f92672">=</span> love.math.random( <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">10</span> )
	self.l2 <span style="color:#f92672">=</span> love.math.random( <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">10</span> )
	self.t1 <span style="color:#f92672">=</span> love.math.random( <span style="color:#f92672">-</span><span style="color:#ae81ff">6.28</span>, <span style="color:#ae81ff">6.28</span> )
	self.t2 <span style="color:#f92672">=</span> love.math.random( <span style="color:#f92672">-</span><span style="color:#ae81ff">6.28</span>, <span style="color:#ae81ff">6.28</span> )
	self.o1 <span style="color:#f92672">=</span> love.math.random( <span style="color:#f92672">-</span><span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">4</span> )
	self.o2 <span style="color:#f92672">=</span> love.math.random( <span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span> )
	self.p1 <span style="color:#f92672">=</span> (self.m1<span style="color:#f92672">+</span>self.m2)<span style="color:#f92672">*</span>(math.pow(self.l1, <span style="color:#ae81ff">2</span>))<span style="color:#f92672">*</span>self.o1 
	<span style="color:#f92672">+</span> self.m2<span style="color:#f92672">*</span>self.l1<span style="color:#f92672">*</span>self.l2<span style="color:#f92672">*</span>self.o2<span style="color:#f92672">*</span>math.cos(self.t1<span style="color:#f92672">-</span>self.t2)
	self.p2 <span style="color:#f92672">=</span> self.m2<span style="color:#f92672">*</span>(math.pow(self.l2, <span style="color:#ae81ff">2</span>))<span style="color:#f92672">*</span>self.o2 
	<span style="color:#f92672">+</span> self.m2<span style="color:#f92672">*</span>self.l1<span style="color:#f92672">*</span>self.l2<span style="color:#f92672">*</span>self.o1<span style="color:#f92672">*</span>math.cos(self.t1<span style="color:#f92672">-</span>self.t2)
	
	<span style="color:#66d9ef">return</span> self
<span style="color:#66d9ef">end</span>

data <span style="color:#f92672">=</span> Generator()
</code></pre></div><p>Now we set up the equations of motion using a function called <code>Hamiltonian</code>. It takes the initial values from <code>data</code> to perform calculations, and a new table called <code>phase</code> which consists of the phase space variables to update the angles and momenta over time:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-lua" data-lang="lua"><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">Hamiltonian</span>(phase, data)

	<span style="color:#66d9ef">local</span> update <span style="color:#f92672">=</span> {}
	
	t1 <span style="color:#f92672">=</span> phase[<span style="color:#ae81ff">1</span>]
	t2 <span style="color:#f92672">=</span> phase[<span style="color:#ae81ff">2</span>]
	p1 <span style="color:#f92672">=</span> phase[<span style="color:#ae81ff">3</span>]
	p2 <span style="color:#f92672">=</span> phase[<span style="color:#ae81ff">4</span>]
	
	C0 <span style="color:#f92672">=</span> data.l1<span style="color:#f92672">*</span>data.l2<span style="color:#f92672">*</span>(data.m1<span style="color:#f92672">+</span>data.m2<span style="color:#f92672">*</span>math.pow(math.sin(t1<span style="color:#f92672">-</span>t2),<span style="color:#ae81ff">2</span>))
	C1 <span style="color:#f92672">=</span> (p1<span style="color:#f92672">*</span>p2<span style="color:#f92672">*</span>math.sin(t1<span style="color:#f92672">-</span>t2))<span style="color:#f92672">/</span>C0
	C2 <span style="color:#f92672">=</span> (data.m2<span style="color:#f92672">*</span>(math.pow(data.l2<span style="color:#f92672">*</span>p1,<span style="color:#ae81ff">2</span>))<span style="color:#f92672">+</span>(data.m1<span style="color:#f92672">+</span>data.m2)<span style="color:#f92672">*</span>
	(math.pow(data.l1<span style="color:#f92672">*</span>p2, <span style="color:#ae81ff">2</span>))<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>data.l1<span style="color:#f92672">*</span>data.l2<span style="color:#f92672">*</span>data.m2<span style="color:#f92672">*</span>p1<span style="color:#f92672">*</span>p2<span style="color:#f92672">*</span>
	math.cos(t1<span style="color:#f92672">-</span>t2))<span style="color:#f92672">*</span>math.sin(<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>(t1<span style="color:#f92672">-</span>t2))<span style="color:#f92672">/</span>(<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>(math.pow(C0,<span style="color:#ae81ff">2</span>)))
	
	update[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> (data.l2<span style="color:#f92672">*</span>p1 <span style="color:#f92672">-</span> data.l1<span style="color:#f92672">*</span>p2<span style="color:#f92672">*</span>math.cos(t1<span style="color:#f92672">-</span>t2)) <span style="color:#f92672">/</span> (data.l1<span style="color:#f92672">*</span>C0)
	update[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">=</span> (data.l1<span style="color:#f92672">*</span>(data.m1<span style="color:#f92672">+</span>data.m2)<span style="color:#f92672">*</span>p2 <span style="color:#f92672">-</span> data.l2<span style="color:#f92672">*</span>data.m2<span style="color:#f92672">*</span>p1<span style="color:#f92672">*</span>
				math.cos(t1<span style="color:#f92672">-</span>t2)) <span style="color:#f92672">/</span> (data.l2<span style="color:#f92672">*</span>data.m2<span style="color:#f92672">*</span>C0)
	update[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">=</span> <span style="color:#f92672">-</span>(data.m1 <span style="color:#f92672">+</span> data.m2)<span style="color:#f92672">*</span>g<span style="color:#f92672">*</span>data.l1<span style="color:#f92672">*</span>math.sin(t1) <span style="color:#f92672">-</span> C1 <span style="color:#f92672">+</span> C2
	update[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">=</span> <span style="color:#f92672">-</span>data.m2<span style="color:#f92672">*</span>g<span style="color:#f92672">*</span>data.l2<span style="color:#f92672">*</span>math.sin(t2) <span style="color:#f92672">+</span> C1 <span style="color:#f92672">-</span> C2
	
	<span style="color:#66d9ef">return</span> update
<span style="color:#66d9ef">end</span>
</code></pre></div><p>All the required information with regard to the physics is now processed. To solve the differential equations, I implemented the Runge-Kutta method of order 4, performing operations on the tables using <code>directSum</code> and <code>scalarMultiply</code>. These operations take place in <code>Solver</code>, which takes the time input <code>dt</code> from LÖVE in <code>love.update()</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-lua" data-lang="lua"><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">Solver</span>(dt)

	<span style="color:#66d9ef">local</span> phase <span style="color:#f92672">=</span> {data.t1, data.t2, data.p1, data.p2}

	<span style="color:#66d9ef">local</span> k1 <span style="color:#f92672">=</span> Hamiltonian(phase, data)
	<span style="color:#66d9ef">local</span> k2 <span style="color:#f92672">=</span> Hamiltonian(directSum(phase, scalarMultiply(dt<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>, k1)), data)
	<span style="color:#66d9ef">local</span> k3 <span style="color:#f92672">=</span> Hamiltonian(directSum(phase, scalarMultiply(dt<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>, k2)), data)
	<span style="color:#66d9ef">local</span> k4 <span style="color:#f92672">=</span> Hamiltonian(directSum(phase, scalarMultiply(dt, k3)), data)
	
	<span style="color:#66d9ef">local</span> R <span style="color:#f92672">=</span> scalarMultiply(<span style="color:#ae81ff">1</span><span style="color:#f92672">/</span><span style="color:#ae81ff">6</span> <span style="color:#f92672">*</span> dt, 	
	directSum(directSum(k1, scalarMultiply(<span style="color:#ae81ff">2.0</span>, k2)), 
	directSum(scalarMultiply(<span style="color:#ae81ff">2.0</span>, k3), k4)))
	
	data.t1 <span style="color:#f92672">=</span> data.t1 <span style="color:#f92672">+</span> R[<span style="color:#ae81ff">1</span>]
	data.t2 <span style="color:#f92672">=</span> data.t2 <span style="color:#f92672">+</span> R[<span style="color:#ae81ff">2</span>]
	data.p1 <span style="color:#f92672">=</span> data.p1 <span style="color:#f92672">+</span> R[<span style="color:#ae81ff">3</span>]
	data.p2 <span style="color:#f92672">=</span> data.p2 <span style="color:#f92672">+</span> R[<span style="color:#ae81ff">4</span>]
<span style="color:#66d9ef">end</span>

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">love</span>.<span style="color:#a6e22e">update</span>()
	Solver(dt)
<span style="color:#66d9ef">end</span>
</code></pre></div><p>After setting up the graphics end, I obtain nice animations like this:
<!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<p>I&rsquo;ll probably end up creating a new post with cool patterns emerging from this simulation, possibly checking for chaotic behaviour with initial conditions that are not so different from a previous state.</p>

	</article>
</main>

<div id="bottom-nav" class="text-center center-block">
	<a href=" https://godot-bloggy.xyz/" class="btn btn-default"><i class="fa fa-home"></i> Home</a>
</div>


  <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "godotmisogi" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


						</div>
					</div>
				</div>
			</div>
		</div>
  </div>
   <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.2/js/bootstrap.min.js"></script>
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js"></script>
  
  <script src="https://godot-bloggy.xyz/js/App.js"></script>
  
  
  <script src="https://godot-bloggy.xyz/js/prism.js"></script>
  
  </body>
</html>
